---
title: "MP4"
author: Nate Mange, Joseph Locurto, Samantha Sweeney, Tingwei Hu
date: "2023-04-12"
output: html_document
bibliography: MP4.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
if(!require(ggpubr)) {install.packages(ggpubr)}
library(ggpubr)
if(!require(jpeg)) {install.packages(jpeg)}
library(jpeg)
if(!require(ggpmisc)) {install.packages(ggpmisc)}
library(ggpmisc)
library(jpeg)
if(!require(knitr)) {install.packages(knitr)}
library(knitr)
```

# Introduction

MP4 delves into the effects of wing shape on flow patterns with foils moving in a fluid. We aimed to predict bird flight behavior by examining the lift and drag components. We used CAD software and 3D printing technology to create two biomimetic wings for the puffin and the swift that reflect their wing morphologies. Flow patterns were analyzed through particle tracking. We strove to establish the flight characteristics that the wings impart to our birds based on lift, drag, and flow pattern data.  

# Methods
We 3D printed wings of *Apus apus* (common swift) and Atlantic *Fratercula arctica* (Atlantic puffin), specifying the shape on the chord and span dimensions of the wing but not the depth. Wings were attached to a 3D printed bird body and placed in a custom swim tunnel at an angle of attack of 15 degrees with water traveling across at 0.1m/s. We measured the amount of lift and drag generated by the wing by attaching the wing-bird model to force transducers on the forward-backwards and up-down axes in relation to the orientation of the model. To qualitatively assess flow, we visualized velocity vectors in FIJI using procedures provided on course website.  

We calculated the lift and drag coefficients and aspect ratio (AR) using methods provided on project website. We fitted a linear model using lift to drag ratio as the dependent variable and aspect ratio as the independent variable using availabe class data at time of analysis.

# Results

```{r,include=TRUE,message=FALSE,echo=FALSE}
puffin<-read.delim("groupjerry_puffin.txt", header = TRUE, sep = ",",dec = ".")

print(paste0('Mean puffin wing lift: ',as.character(mean(puffin$lift))))
#26.65229
print(paste0('Mean puffin wing drag: ',as.character(mean(puffin$drag))))
#5.229446

Cd_puff <- (mean(puffin$drag))/(0.5*1000*0.1^2*0.00102)
Cl_puff <- (mean(puffin$lift))/(0.5*1000*0.1^2*0.00102)
ClCd_puff <- Cl_puff/Cd_puff


swift<-read.delim("groupjerry_swift.txt", header = TRUE, sep = ",",dec = ".")

print(paste0('Mean swift wing lift: ',as.character(mean(swift$lift))))
#26.65229
print(paste0('Mean swift wing drag: ',as.character(mean(swift$drag))))
#5.229446

Cd_swift <- (mean(swift$drag))/(0.5*1000*0.1^2*0.00102)
Cl_swift <- (mean(swift$lift))/(0.5*1000*0.1^2*0.00102)
ClCd_swift <-Cl_swift/Cd_swift

print(paste0('Lift to drag ratio for puffin: ', as.character(ClCd_puff)))
print(paste0('Lift to drag ratio for swift: ', as.character(ClCd_swift)))

```
```{r,ar vs lift to drag,message=FALSE,fig.cap='**Figure 1: **Correlation between lift to drag ratio and AR.'}
class_dat <- read_csv('classdata.csv')

class_dat <- class_dat %>% 
  drop_na() %>%
  rename('l2d' = 'Cl/Cd')

class_dat %>% 
  ggplot(aes(AR,l2d))+geom_point()+geom_smooth(method=lm,se=FALSE)+
  stat_poly_eq()+
  theme(axis.line = element_line(colour = "black"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    panel.background = element_blank())+
  ylab('Lift to Drag Ratio')+
  xlab('Aspect Ratio')
```

```{r,linear model,message=FALSE}
lm1 <- lm(l2d ~ AR, class_dat)

summary(lm1)

confint(lm1)
```

# Discussion

## Question 1
The relationship between AR and lift-to-drag ratio is hypothesized to be positive, with an increase in AR generally leading to a higher lift-to-drag ratio. A high AR is correlated with a generally longer and slimmer wing, compared to a low AR characterized by a shorter and wider wing. The basis for a higher AR being correlated with a higher lift-to-drag ratio is due to a reduction in induced drag when AR is increased. With a longer wingspan, the flow of air and downwash contributing to a vortex and loss of energy at the wingtips is more spread out, which decreases the amount of induced drag generated. Based on the class data, the proposed hypothesis can be confirmed, with higher reported AR yielded higher calculated Cl/Cd ratios. 

## Question 2
Within our group’s work alone, it is known that the common swift is a gliding animal while puffins rapidly flap their wings, sometimes hundreds of times a minute. Looking at other groups’ data, another gliding bird would be the peregrine falcon. The peregrine falcons have Cl/Cd of between 10.25 and 12.61 and the common swift has a value of 9.95. These values are much larger than those of flapping birds like the puffin (5.029) and the warbler (0.727), values significantly smaller than the peregrine falcon and the puffin. This makes sense as a higher Cl/Cd ratio indicates a greater production of lift than drag, enabling longer periods of flight.  areas and forests.

## Question 3
Soaring easily enables birds to cover long distances with minimal energy expenditure - though it does come with tradeoffs. Soaring birds typically have larger wingspans and heavier bodies than non-soaring birds. This makes them less agile and more vulnerable to predators. Soaring birds typically require strong thermal currents to maintain altitude, limiting their range. Thermal currents are rising columns of warm air that are formed by the sun heating the ground. When the surface air becomes warmer than the surrounding air, it rises and creates a thermal current. Soaring birds use these currents to gain and maintain altitude without flapping their wings (@leshem1996use). These currents are more common in areas where the surface air heats up quickly, such as deserts. Birds that cannot soar easily tend to be more agile and can fly in a wider range of environments such as coastal areas and forests.

## Question 4
Bird bodies have many adaptations that optimize lift resulting from the wing. Birds typically have long, narrow wings with a curved, streamlined body shape. A bird’s flat or slightly curved wings help generate lift by creating differences in pressure above and below the wing (high pressure below, low pressure above). The presence of feathers creates a smooth surface over which air can flow - furthering the body's streamlined shape. More specifically, slotted tips at the end of a birds’ wings can work to reduce drag by acting as winglets, or smaller wings attached to the tips of a base wing (@tucker1993gliding). This helps reduce drag and increase efficiency. Lastly, a bird’s hollow bones decrease its weight, making it easier for them to take off and fly.

## Question 5
We did not find correlation between AR and lift to drag ratio, contrary to our expectation of a positive correlation and as reported by @bataille2007fixed, who found that a higher AR would lead to a higher lift-to-drag ratio but would decrease the maximum lift coefficient. It could be that our AR spanned a wide range to the point where the reduction in maximum lift coefficient had an effect on our lift to drag ratio.

## Question 6
The flow patterns were different between the two models. For the puffin, there is evidence of a large amount of vortices being produced around the wing model in the quantity of red pixels, which represent pixel movement in the vertical plane, and purple pixels, which represent pixel movement in the negative horizontal plane. Red and purple being present demonstrates the production of vortices because they signal that the fluid around the wings - which is visualized through the fluorescent spheres it carries along - has been diverted from its original path. Analysis of the swift model, however, produces a distinctly different picture, one with few red pixels and almost no purple pixels. The domination of the image by green pixels indicates that the swift’s wings produce few vortices.  

[Vortices decrease the quantity of lift that can be produced by a wing](https://howthingsfly.si.edu/aerodynamics/vortex-drag). The puffin’s optic flow analysis shows many more vortices than the swift’s, and this is reflected in the lift coefficients of the organisms: 11,640 and 52,259, respectively. In other words, the puffins' much lower lift coefficient is reflected in the much larger quantity of vortices that its wings produce. 
```{r,import images,message=FALSE,echo=FALSE,fig.cap='**Figure 2: ** Puffin wings vortices analysis.'}
plot_jpeg <-  function(path, add=FALSE)
{
  require('jpeg')
  jpg = readJPEG(path, native=T) # read the file
  res = dim(jpg)[2:1] # get the resolution, [x, y]
  if (!add) # initialize an empty plot area if add==FALSE
    plot(1,1,xlim=c(1,res[1]),ylim=c(1,res[2]),asp=1,type='n',xaxs='i',yaxs='i',xaxt='n',yaxt='n',xlab='',ylab='',bty='n')
  rasterImage(jpg,1,1,res[1],res[2])
}

plot_jpeg('Puffin_OF.jpg')
```


```{r,message=FALSE,fig.cap='**Figure 3: ** Swift wing vortices analysis.'}
plot_jpeg('Swift_OF.jpg')
```


# Author Contributions
All authors contributed equally to the project.

# References

